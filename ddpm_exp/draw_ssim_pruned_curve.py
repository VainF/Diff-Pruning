import matplotlib.pyplot as plt
import numpy as np

plt.style.use('seaborn-whitegrid')

ssim = [0.7881933450698853, 0.8069899082183838, 0.8119480609893799, 0.8162015080451965, 0.8389594554901123, 0.8415904641151428, 0.8398601412773132, 0.8351159691810608, 0.8382353186607361, 0.8380391001701355, 0.8358467221260071, 0.8335589170455933, 0.8339887857437134, 0.8341929316520691, 0.8322316408157349, 0.8351540565490723, 0.8365049958229065, 0.8395034074783325, 0.8369854092597961, 0.8361033797264099]
loss = [1701.1046142578125, 1480.7890625, 1344.899658203125, 1244.06982421875, 1163.198486328125, 1095.482421875, 1037.3287353515625, 986.4912109375, 941.4730224609375, 901.2019653320312, 864.8944091796875, 831.9296875, 801.815185546875, 774.1593017578125, 748.635498046875, 724.9940795898438, 703.0166015625, 682.5120239257812, 663.32568359375, 645.3184204101562, 628.3749389648438, 612.4005126953125, 597.3052978515625, 583.0064697265625, 569.4385986328125, 556.5473022460938, 544.2760009765625, 532.5770874023438, 521.4034423828125, 510.709716796875, 500.46917724609375, 490.6474914550781, 481.222412109375, 472.17437744140625, 463.4827575683594, 455.11700439453125, 447.05352783203125, 439.2783203125, 431.7735595703125, 424.529541015625, 417.5376281738281, 410.7806701660156, 404.24041748046875, 397.9093017578125, 391.771728515625, 385.82086181640625, 380.05987548828125, 374.47900390625, 369.06243896484375, 363.7962646484375, 358.68304443359375, 353.7085266113281, 348.8709716796875, 344.1724853515625, 339.605224609375, 335.15997314453125, 330.8258972167969, 326.5983581542969, 322.47613525390625, 318.45684814453125, 314.5384826660156, 310.71697998046875, 306.98724365234375, 303.3455810546875, 299.7877197265625, 296.310791015625, 292.9114990234375, 289.58966064453125, 286.3433837890625, 283.16998291015625, 280.06707763671875, 277.03326416015625, 274.06695556640625, 271.161865234375, 268.31640625, 265.52734375, 262.79425048828125, 260.1163330078125, 257.49163818359375, 254.91751098632812, 252.3910369873047, 249.91122436523438, 247.47616577148438, 245.088623046875, 242.750732421875, 240.45819091796875, 238.20266723632812, 235.9857177734375, 233.80799865722656, 231.66690063476562, 229.56248474121094, 227.4961395263672, 225.4654541015625, 223.46958923339844, 221.50381469726562, 219.56704711914062, 217.66116333007812, 215.78857421875, 213.94786071777344, 212.13548278808594, 210.34634399414062, 208.5807342529297, 206.84222412109375, 205.13070678710938, 203.44268798828125, 201.78305053710938, 200.1453399658203, 198.532958984375, 196.9427490234375, 195.3751220703125, 193.82810974121094, 192.3029022216797, 190.79945373535156, 189.3192596435547, 187.86029052734375, 186.42015075683594, 184.99755859375, 183.5935516357422, 182.20855712890625, 180.8433380126953, 179.49468994140625, 178.16262817382812, 176.84832763671875, 175.5514678955078, 174.27105712890625, 173.00845336914062, 171.76220703125, 170.53294372558594, 169.3196563720703, 168.12110900878906, 166.9364471435547, 165.76898193359375, 164.61373901367188, 163.47064208984375, 162.33859252929688, 161.22225952148438, 160.12184143066406, 159.03469848632812, 157.95745849609375, 156.89071655273438, 155.836181640625, 154.79522705078125, 153.76693725585938, 152.75314331054688, 151.74832153320312, 150.75482177734375, 149.77114868164062, 148.79794311523438, 147.83566284179688, 146.88336181640625, 145.94140625, 145.0076141357422, 144.08383178710938, 143.16946411132812, 142.2662353515625, 141.37387084960938, 140.49444580078125, 139.6236572265625, 138.75778198242188, 137.9005889892578, 137.05108642578125, 136.20909118652344, 135.3750457763672, 134.55081176757812, 133.73622131347656, 132.92990112304688, 132.1318359375, 131.3417510986328, 130.55929565429688, 129.7850341796875, 129.01817321777344, 128.2555694580078, 127.50141906738281, 126.75614929199219, 126.01831817626953, 125.28939819335938, 124.56617736816406, 123.84973907470703, 123.13714599609375, 122.43183135986328, 121.73556518554688, 121.05023956298828, 120.36729431152344, 119.6861801147461, 119.00979614257812, 118.34149932861328, 117.68106079101562, 117.0245361328125, 116.37326049804688, 115.72502899169922, 115.0794677734375, 114.43995666503906, 113.80744934082031, 113.185302734375, 112.56655883789062, 111.9501724243164, 111.33888244628906, 110.731201171875, 110.12779998779297, 109.52902221679688, 108.93549346923828, 108.3429183959961, 107.75627899169922, 107.17346954345703, 106.59703063964844, 106.02497863769531, 105.45870971679688, 104.89581298828125, 104.33368682861328, 103.77556610107422, 103.22441101074219, 102.67940521240234, 102.13814544677734, 101.595947265625, 101.05874633789062, 100.52738189697266, 99.99861145019531, 99.47378540039062, 98.95279693603516, 98.43711853027344, 97.927490234375, 97.41922760009766, 96.91082763671875, 96.40644836425781, 95.91044616699219, 95.42032623291016, 94.93365478515625, 94.44966125488281, 93.96620178222656, 93.48726654052734, 93.01268005371094, 92.54640197753906, 92.08195495605469, 91.62220764160156, 91.16517639160156, 90.71146392822266, 90.26289367675781, 89.81585693359375, 89.37476348876953, 88.93356323242188, 88.49430084228516, 88.05615234375, 87.62488555908203, 87.20310974121094, 86.78509521484375, 86.36715698242188, 85.94837188720703, 85.5322036743164, 85.119384765625, 84.70726013183594, 84.29851531982422, 83.8918685913086, 83.4896469116211, 83.08975219726562, 82.6915283203125, 82.2962417602539, 81.90049743652344, 81.50473022460938, 81.11053466796875, 80.71994018554688, 80.33277130126953, 79.95138549804688, 79.5705337524414, 79.19496154785156, 78.82186889648438, 78.44967651367188, 78.078125, 77.70683288574219, 77.33111572265625, 76.96113586425781, 76.59521484375, 76.23463439941406, 75.8738784790039, 75.5166015625, 75.15583038330078, 74.7983627319336, 74.4422378540039, 74.08897399902344, 73.74169921875, 73.39446258544922, 73.05160522460938, 72.7100830078125, 72.37609100341797, 72.03876495361328, 71.70317077636719, 71.36734008789062, 71.03208923339844, 70.6976318359375, 70.36759185791016, 70.03667449951172, 69.70942687988281, 69.38262176513672, 69.05623626708984, 68.73023223876953, 68.40640258789062, 68.08369445800781, 67.76331329345703, 67.44386291503906, 67.12708282470703, 66.80943298339844, 66.49469757080078, 66.18429565429688, 65.87628173828125, 65.56700897216797, 65.25809478759766, 64.94975280761719, 64.64031219482422, 64.33030700683594, 64.01728057861328, 63.7086181640625, 63.404884338378906, 63.10600662231445, 62.80165481567383, 62.49952697753906, 62.1977653503418, 61.896236419677734, 61.5944709777832, 61.29471969604492, 60.99738311767578, 60.701576232910156, 60.40677261352539, 60.11320877075195, 59.82258224487305, 59.53261947631836, 59.24340057373047, 58.95545959472656, 58.671363830566406, 58.38852310180664, 58.108306884765625, 57.82665252685547, 57.54595947265625, 57.266910552978516, 56.98750686645508, 56.709312438964844, 56.431488037109375, 56.154640197753906, 55.880706787109375, 55.60820007324219, 55.33389663696289, 55.061912536621094, 54.790802001953125, 54.52444076538086, 54.25933837890625, 53.99445724487305, 53.730342864990234, 53.46611022949219, 53.19966125488281, 52.93572998046875, 52.67394256591797, 52.416324615478516, 52.15863037109375, 51.9014892578125, 51.64102554321289, 51.380699157714844, 51.123252868652344, 50.869956970214844, 50.619815826416016, 50.36848068237305, 50.117496490478516, 49.864952087402344, 49.614585876464844, 49.36606216430664, 49.11790084838867, 48.872718811035156, 48.6287841796875, 48.383766174316406, 48.13976287841797, 47.89812469482422, 47.65973663330078, 47.42310333251953, 47.187564849853516, 46.95360565185547, 46.718772888183594, 46.485862731933594, 46.25577926635742, 46.027374267578125, 45.79834747314453, 45.57139587402344, 45.344879150390625, 45.12104797363281, 44.89805603027344, 44.67631530761719, 44.45355987548828, 44.230438232421875, 44.00713348388672, 43.78421401977539, 43.56409454345703, 43.346736907958984, 43.13029098510742, 42.91291809082031, 42.694793701171875, 42.47801971435547, 42.26348876953125, 42.0494384765625, 41.83710479736328, 41.625648498535156, 41.414955139160156, 41.20560073852539, 40.99818420410156, 40.791481018066406, 40.585731506347656, 40.380332946777344, 40.17467498779297, 39.96947479248047, 39.76425552368164, 39.55950164794922, 39.355892181396484, 39.152591705322266, 38.949493408203125, 38.745704650878906, 38.54241180419922, 38.34136199951172, 38.14094924926758, 37.94009017944336, 37.73867416381836, 37.537044525146484, 37.336360931396484, 37.13530731201172, 36.934104919433594, 36.73320007324219, 36.53413391113281, 36.33588409423828, 36.13719940185547, 35.937522888183594, 35.739013671875, 35.542327880859375, 35.34554672241211, 35.149192810058594, 34.954002380371094, 34.75892639160156, 34.56444549560547, 34.37016296386719, 34.175926208496094, 33.980865478515625, 33.78504943847656, 33.58888244628906, 33.393436431884766, 33.19927215576172, 33.0058708190918, 32.81242752075195, 32.61833953857422, 32.423622131347656, 32.22987365722656, 32.03801345825195, 31.847660064697266, 31.658077239990234, 31.468374252319336, 31.278139114379883, 31.088520050048828, 30.89966583251953, 30.711360931396484, 30.523611068725586, 30.336217880249023, 30.14923095703125, 29.963003158569336, 29.778030395507812, 29.593975067138672, 29.410850524902344, 29.228641510009766, 29.04698371887207, 28.86606216430664, 28.686256408691406, 28.507423400878906, 28.328943252563477, 28.150875091552734, 27.97317123413086, 27.796123504638672, 27.619800567626953, 27.44475555419922, 27.27039337158203, 27.096721649169922, 26.923952102661133, 26.751808166503906, 26.58050537109375, 26.410259246826172, 26.241487503051758, 26.073375701904297, 25.90522003173828, 25.737794876098633, 25.571483612060547, 25.406145095825195, 25.241474151611328, 25.077468872070312, 24.914419174194336, 24.752695083618164, 24.592121124267578, 24.43234634399414, 24.273231506347656, 24.114547729492188, 23.955957412719727, 23.798091888427734, 23.641109466552734, 23.484966278076172, 23.329912185668945, 23.17569923400879, 23.02271842956543, 22.87088966369629, 22.720455169677734, 22.570812225341797, 22.421768188476562, 22.27305793762207, 22.12588119506836, 21.979734420776367, 21.83547592163086, 21.692113876342773, 21.54950714111328, 21.406421661376953, 21.263275146484375, 21.122180938720703, 20.982616424560547, 20.842681884765625, 20.70368766784668, 20.565185546875, 20.427291870117188, 20.289962768554688, 20.153470993041992, 20.017803192138672, 19.883617401123047, 19.750282287597656, 19.616554260253906, 19.483001708984375, 19.3499755859375, 19.217700958251953, 19.086288452148438, 18.956266403198242, 18.826961517333984, 18.699195861816406, 18.57220458984375, 18.44577407836914, 18.320362091064453, 18.19457244873047, 18.069015502929688, 17.943695068359375, 17.81871795654297, 17.69390106201172, 17.569774627685547, 17.445335388183594, 17.32052230834961, 17.196054458618164, 17.072261810302734, 16.949085235595703, 16.826692581176758, 16.704326629638672, 16.581392288208008, 16.458843231201172, 16.336633682250977, 16.215139389038086, 16.094675064086914, 15.97494888305664, 15.855484962463379, 15.736421585083008, 15.61740493774414, 15.499762535095215, 15.383194923400879, 15.267399787902832, 15.1524658203125, 15.037047386169434, 14.921875, 14.807332992553711, 14.6937837600708, 14.581942558288574, 14.471169471740723, 14.359855651855469, 14.247969627380371, 14.136343002319336, 14.0252103805542, 13.91417121887207, 13.804189682006836, 13.695024490356445, 13.586652755737305, 13.478588104248047, 13.370796203613281, 13.263662338256836, 13.156829833984375, 13.050079345703125, 12.943574905395508, 12.8375244140625, 12.732397079467773, 12.627817153930664, 12.523782730102539, 12.420042037963867, 12.316635131835938, 12.213995933532715, 12.112537384033203, 12.011775970458984, 11.911060333251953, 11.81020736694336, 11.709442138671875, 11.609159469604492, 11.510124206542969, 11.41226577758789, 11.314695358276367, 11.217529296875, 11.120745658874512, 11.024354934692383, 10.928537368774414, 10.833683013916016, 10.739753723144531, 10.646350860595703, 10.553449630737305, 10.460601806640625, 10.368167877197266, 10.275918960571289, 10.184614181518555, 10.094273567199707, 10.00442123413086, 9.915353775024414, 9.826492309570312, 9.737730979919434, 9.649423599243164, 9.56181526184082, 9.474851608276367, 9.3887939453125, 9.303421020507812, 9.218555450439453, 9.134313583374023, 9.050726890563965, 8.967226028442383, 8.884288787841797, 8.80159854888916, 8.71987533569336, 8.638511657714844, 8.55799674987793, 8.477949142456055, 8.398301124572754, 8.319267272949219, 8.240785598754883, 8.16270637512207, 8.084941864013672, 8.00758171081543, 7.930901050567627, 7.854917526245117, 7.779313087463379, 7.70433235168457, 7.629762649536133, 7.555689811706543, 7.482339859008789, 7.409557342529297, 7.336893081665039, 7.26435661315918, 7.192422866821289, 7.1210832595825195, 7.050585746765137, 6.980339527130127, 6.910588264465332, 6.841214179992676, 6.772533893585205, 6.7045183181762695, 6.637387275695801, 6.570642948150635, 6.504342079162598, 6.438445568084717, 6.372898101806641, 6.307552337646484, 6.242652416229248, 6.1783342361450195, 6.114615440368652, 6.05164909362793, 5.989071369171143, 5.926817893981934, 5.864975929260254, 5.8035430908203125, 5.742734909057617, 5.6824235916137695, 5.622620105743408, 5.56337308883667, 5.504632472991943, 5.44635009765625, 5.388323783874512, 5.330789089202881, 5.273573398590088, 5.216763019561768, 5.160672187805176, 5.105111122131348, 5.0502824783325195, 4.995979309082031, 4.941986083984375, 4.887808799743652, 4.834039688110352, 4.780519485473633, 4.727843284606934, 4.675847053527832, 4.624444007873535, 4.573704719543457, 4.523074150085449, 4.472465515136719, 4.4224443435668945, 4.372983932495117, 4.324192047119141, 4.275915145874023, 4.227880954742432, 4.180074691772461, 4.132648944854736, 4.085781097412109, 4.03977632522583, 3.993844747543335, 3.948244094848633, 3.9029383659362793, 3.8578546047210693, 3.8133997917175293, 3.7693405151367188, 3.7258453369140625, 3.682644844055176, 3.6398329734802246, 3.5972371101379395, 3.555053234100342, 3.51322078704834, 3.47196102142334, 3.4310460090637207, 3.3906357288360596, 3.350480079650879, 3.3109285831451416, 3.27160382270813, 3.2327582836151123, 3.1944308280944824, 3.156402826309204, 3.118509292602539, 3.081109046936035, 3.0437707901000977, 3.006779670715332, 2.970116138458252, 2.9337751865386963, 2.8978099822998047, 2.862208366394043, 2.827075958251953, 2.7925100326538086, 2.75809383392334, 2.7239840030670166, 2.690075159072876, 2.6565277576446533, 2.6233577728271484, 2.59077787399292, 2.5584311485290527, 2.52634859085083, 2.494575262069702, 2.4631528854370117, 2.4322350025177, 2.401658535003662, 2.3714113235473633, 2.341179370880127, 2.311309576034546, 2.281765937805176, 2.2527246475219727, 2.223891496658325, 2.19508695602417, 2.166395664215088, 2.1379075050354004, 2.109847068786621, 2.0825068950653076, 2.055701732635498, 2.0291335582733154, 2.0026559829711914, 1.9766024351119995, 1.9506968259811401, 1.9250354766845703, 1.8999783992767334, 1.8748676776885986, 1.8499674797058105, 1.825405478477478, 1.80095636844635, 1.7769408226013184, 1.7534890174865723, 1.7300043106079102, 1.7066116333007812, 1.6833750009536743, 1.6603283882141113, 1.637768030166626, 1.615763783454895, 1.5940053462982178, 1.5724085569381714, 1.5510432720184326, 1.5298420190811157, 1.5087008476257324, 1.4878756999969482, 1.46720552444458, 1.4469165802001953, 1.42703378200531, 1.4072201251983643, 1.3874483108520508, 1.368030309677124, 1.3487962484359741, 1.3297483921051025, 1.3111402988433838, 1.2925734519958496, 1.2742488384246826, 1.2563354969024658, 1.239056944847107, 1.221704125404358, 1.2041783332824707, 1.1868020296096802, 1.169940710067749, 1.1533498764038086, 1.137148380279541, 1.1206257343292236, 1.1041970252990723, 1.0881215333938599, 1.0724332332611084, 1.0570216178894043, 1.0418777465820312, 1.027139663696289, 1.01233971118927, 0.9975317716598511, 0.982831597328186, 0.9682676196098328, 0.9541558027267456, 0.9400227665901184, 0.9261940717697144, 0.912714421749115, 0.8991694450378418, 0.8859115839004517, 0.8725903630256653, 0.8595502376556396, 0.8467142581939697, 0.8339176774024963, 0.8214421272277832, 0.8089535236358643, 0.7969492673873901, 0.7850332856178284, 0.773577868938446, 0.7619916796684265, 0.750514566898346, 0.7390782833099365, 0.727920651435852, 0.7166476845741272, 0.7057903409004211, 0.6950562596321106, 0.6844556331634521, 0.6740690469741821, 0.6636630296707153, 0.6534810662269592, 0.6433228850364685, 0.633602499961853, 0.6237667202949524, 0.6142684817314148, 0.604796290397644, 0.5954349040985107, 0.5865603685379028, 0.5772913694381714, 0.5682709217071533, 0.5592767000198364, 0.5505585670471191, 0.542014479637146, 0.5336143374443054, 0.5253323316574097, 0.5171076059341431, 0.5091003179550171, 0.5012395977973938, 0.493182897567749, 0.48534587025642395, 0.47781723737716675, 0.4703660011291504, 0.46325814723968506, 0.4561285972595215, 0.4492647051811218, 0.44225677847862244, 0.4352635145187378, 0.4283895790576935, 0.42159581184387207, 0.4147633910179138, 0.40812188386917114, 0.4014328718185425, 0.39500337839126587, 0.3887244760990143, 0.3823932707309723, 0.3762394189834595, 0.37033089995384216, 0.3649292290210724, 0.35929298400878906, 0.3535959720611572, 0.34809982776641846, 0.342424601316452, 0.33691826462745667, 0.3312578797340393, 0.32602420449256897, 0.3210577368736267, 0.3160027861595154, 0.31118467450141907, 0.30630141496658325, 0.3016233444213867, 0.2967444062232971, 0.2918931841850281, 0.2870868444442749, 0.28218063712120056, 0.27778011560440063, 0.2733995318412781, 0.26912352442741394, 0.2651045024394989, 0.2612626552581787, 0.257208913564682, 0.2527666687965393, 0.24844947457313538, 0.2442183792591095, 0.2404608428478241, 0.23674535751342773, 0.2332439422607422, 0.22945661842823029, 0.22556596994400024, 0.22160732746124268, 0.21786770224571228, 0.21428701281547546, 0.21095798909664154, 0.20757737755775452, 0.20441585779190063, 0.20126710832118988, 0.19809749722480774, 0.19500720500946045, 0.19189956784248352, 0.18880324065685272, 0.18582747876644135, 0.18278327584266663, 0.18014571070671082, 0.17744965851306915, 0.1748645305633545, 0.1720936894416809, 0.16946980357170105, 0.16655337810516357, 0.16428059339523315, 0.16178739070892334, 0.15912079811096191, 0.1564910113811493, 0.15409769117832184, 0.1519279032945633, 0.14959266781806946, 0.14729416370391846, 0.14519476890563965, 0.14297731220722198, 0.14067870378494263, 0.1384662240743637, 0.13619963824748993, 0.13372863829135895, 0.13164782524108887, 0.12953300774097443, 0.12771821022033691, 0.12615008652210236, 0.12415669858455658, 0.1224883422255516, 0.12066398561000824, 0.11871618032455444, 0.11666613817214966, 0.11477735638618469, 0.11323611438274384, 0.11176219582557678, 0.11029437184333801, 0.10888860374689102, 0.10724224895238876, 0.10557863116264343, 0.10384707897901535, 0.10236769914627075, 0.1006280779838562, 0.09903483092784882, 0.09761733561754227, 0.09611119329929352, 0.09474831074476242, 0.09324538707733154, 0.0919327437877655, 0.09046762436628342, 0.08917433023452759, 0.08783926069736481, 0.08677000552415848, 0.08565567433834076, 0.08473670482635498, 0.08394858241081238, 0.08294089138507843, 0.08191481232643127, 0.08059291541576385, 0.07923152297735214, 0.07800912857055664, 0.07714410126209259, 0.07613521814346313, 0.07499660551548004, 0.0738428384065628, 0.0728812888264656, 0.07185603678226471, 0.07075358927249908, 0.06998489797115326, 0.06904087215662003, 0.06817013025283813, 0.0675143226981163, 0.06662875413894653, 0.06585747003555298, 0.06498762965202332, 0.06416307389736176, 0.06331884860992432, 0.06252430379390717, 0.06164319068193436, 0.0608375146985054, 0.06004999577999115, 0.05958651006221771, 0.05899893864989281, 0.05812441185116768, 0.05736687779426575, 0.05654726177453995, 0.05582256615161896, 0.055398836731910706, 0.05473468452692032, 0.05418632924556732, 0.053625207394361496, 0.05313240364193916, 0.05263800173997879, 0.05228545516729355]
loss = loss / np.max(loss)
stage = list(range(50, 1000+1, 50))

# Set the font size
plt.rcParams['font.family'] = 'serif'
plt.rcParams['font.size'] = 23

# Define custom colors in a dark color scheme
color_blue = '#002147'
color_red = '#8C1515'
background_color = '#F0F0F0'

# Set the figure size
plt.figure(figsize=(10, 4))

# Set the background color
plt.rcParams['axes.facecolor'] = background_color

# Plot SSIM with markers
ax1 = plt.gca()
ax1.set_ylabel('SSIM')
ax1.plot(stage, ssim, marker='o', linestyle='-', label='SSIM', color=color_blue)

# Plot Loss with markers
ax2 = plt.twinx()
ax2.set_ylabel('Relative Loss')
ax2.plot(np.arange(len(loss)), loss, label='Relative Loss', color=color_red)

# Set x-axis label
ax1.set_xlabel('Steps')

# Add vertical dashed line and text
ax1.axvline(x=300, color='#777777aa', linestyle='dashed')
ax2.text(300 + 10, 0.35, 'Threshold $\mathcal{T}$', rotation=90, color='gray', fontsize=12)

# Adjust the alignment of twin axes
ax1.spines['left'].set_color(color_blue)
ax1.spines['right'].set_visible(False)
ax1.yaxis.label.set_color(color_blue)
ax1.tick_params(axis='y', colors=color_blue)
ax2.spines['right'].set_color(color_red)
ax2.spines['left'].set_visible(False)
ax2.yaxis.label.set_color(color_red)
ax2.tick_params(axis='y', colors=color_red)

# Set the y-axis limits for Loss
ax2.set_ylim([0, np.max(loss)])

# Show legend in one box
lines, labels = ax1.get_legend_handles_labels()
lines2, labels2 = ax2.get_legend_handles_labels()
ax2.legend(lines + lines2, labels + labels2, loc='lower right')

# Set the title

# Add grid
plt.grid(color='white', linestyle='-', linewidth=0.5)

# Set the layout and padding
plt.tight_layout(pad=1.0)

# Save the figure
plt.title("CIFAR-10")
plt.savefig('run/ssim_loss.pdf', dpi=300)
plt.savefig('run/ssim_loss.png', dpi=300)

plt.close()










ssim = [0.5799465179443359, 0.6136730909347534, 0.6535662412643433, 0.6940350532531738, 0.7176114916801453, 0.7297082543373108, 0.7317281365394592, 0.7415740489959717, 0.731893002986908, 0.7338791489601135, 0.7469093799591064, 0.7643880248069763, 0.7528172135353088, 0.7652474045753479, 0.7676505446434021, 0.7659737467765808, 0.7663692831993103, 0.7921077609062195, 0.7951106429100037, 0.7900822162628174]
loss = [4539.2880859375, 3768.095947265625, 3357.234375, 3075.648681640625, 2858.8349609375, 2681.1640625, 2529.66748046875, 2396.486083984375, 2277.68798828125, 2170.572265625, 2073.0498046875, 1983.8221435546875, 1901.969482421875, 1826.51416015625, 1756.9361572265625, 1692.67529296875, 1632.9080810546875, 1577.036865234375, 1524.709228515625, 1475.60205078125, 1429.496826171875, 1386.111572265625, 1345.2410888671875, 1306.699462890625, 1270.2772216796875, 1235.816650390625, 1203.143310546875, 1172.09619140625, 1142.5673828125, 1114.4703369140625, 1087.7288818359375, 1062.2257080078125, 1037.8934326171875, 1014.63818359375, 992.4036865234375, 971.1495361328125, 950.8143310546875, 931.31298828125, 912.5927734375, 894.5926513671875, 877.2578125, 860.58203125, 844.5435180664062, 829.0625, 814.1162109375, 799.66796875, 785.71142578125, 772.231201171875, 759.2171630859375, 746.6537475585938, 734.4761962890625, 722.6871948242188, 711.263916015625, 700.1922607421875, 689.4476318359375, 679.0269775390625, 668.9332885742188, 659.1286010742188, 649.6156005859375, 640.3824462890625, 631.3946533203125, 622.6455078125, 614.136962890625, 605.8540649414062, 597.7898559570312, 589.9388427734375, 582.287109375, 574.8184814453125, 567.5428466796875, 560.46044921875, 553.5679931640625, 546.8153076171875, 540.208251953125, 533.760986328125, 527.4842529296875, 521.3709716796875, 515.41015625, 509.5645751953125, 503.8065490722656, 498.16217041015625, 492.656494140625, 487.27862548828125, 482.0224914550781, 476.8771667480469, 471.83258056640625, 466.8781433105469, 462.02825927734375, 457.2860107421875, 452.6307373046875, 448.0614013671875, 443.5903015136719, 439.2196044921875, 434.9393310546875, 430.72430419921875, 426.5743713378906, 422.4966735839844, 418.49322509765625, 414.55938720703125, 410.68951416015625, 406.8865966796875, 403.1524658203125, 399.4714050292969, 395.8497619628906, 392.2903137207031, 388.796630859375, 385.36053466796875, 381.9772033691406, 378.6322326660156, 375.3372497558594, 372.1002197265625, 368.9242858886719, 365.79498291015625, 362.7067565917969, 359.657470703125, 356.65362548828125, 353.6961669921875, 350.78558349609375, 347.9106750488281, 345.0701904296875, 342.27056884765625, 339.5118713378906, 336.7920227050781, 334.1104736328125, 331.4671630859375, 328.8617858886719, 326.29071044921875, 323.758056640625, 321.26202392578125, 318.79345703125, 316.34747314453125, 313.92901611328125, 311.5457458496094, 309.1994934082031, 306.8837890625, 304.5982360839844, 302.3414611816406, 300.10614013671875, 297.8866271972656, 295.6922607421875, 293.5301513671875, 291.3970031738281, 289.29144287109375, 287.2158203125, 285.16796875, 283.1424560546875, 281.13409423828125, 279.1377258300781, 277.15594482421875, 275.20147705078125, 273.274658203125, 271.3721618652344, 269.4991455078125, 267.65350341796875, 265.8316650390625, 264.02655029296875, 262.23492431640625, 260.45770263671875, 258.69610595703125, 256.95526123046875, 255.234130859375, 253.54019165039062, 251.86520385742188, 250.21116638183594, 248.5689239501953, 246.93984985351562, 245.31585693359375, 243.70863342285156, 242.11697387695312, 240.54721069335938, 238.99844360351562, 237.47918701171875, 235.97952270507812, 234.4829559326172, 232.99127197265625, 231.49490356445312, 230.009033203125, 228.55003356933594, 227.11834716796875, 225.71218872070312, 224.3217010498047, 222.94598388671875, 221.5821990966797, 220.22264099121094, 218.86444091796875, 217.51229858398438, 216.1671600341797, 214.83935546875, 213.5290985107422, 212.23281860351562, 210.94717407226562, 209.6590118408203, 208.39019775390625, 207.14077758789062, 205.90513610839844, 204.6878662109375, 203.48330688476562, 202.28472900390625, 201.0923309326172, 199.90463256835938, 198.7206268310547, 197.548828125, 196.3909912109375, 195.24566650390625, 194.1101531982422, 192.98435974121094, 191.87210083007812, 190.7747344970703, 189.68112182617188, 188.5771484375, 187.48060607910156, 186.40255737304688, 185.33895874023438, 184.28480529785156, 183.2340545654297, 182.18869018554688, 181.15188598632812, 180.12258911132812, 179.10223388671875, 178.09197998046875, 177.0926513671875, 176.10470581054688, 175.13047790527344, 174.16094970703125, 173.19235229492188, 172.22509765625, 171.26443481445312, 170.31271362304688, 169.37289428710938, 168.43927001953125, 167.5128173828125, 166.6007080078125, 165.69393920898438, 164.78707885742188, 163.87860107421875, 162.9747772216797, 162.08349609375, 161.205810546875, 160.3376922607422, 159.48043823242188, 158.62545776367188, 157.76852416992188, 156.90916442871094, 156.06423950195312, 155.22775268554688, 154.40029907226562, 153.5887451171875, 152.77359008789062, 151.96192932128906, 151.1425018310547, 150.33209228515625, 149.52468872070312, 148.72679138183594, 147.93780517578125, 147.1558837890625, 146.38275146484375, 145.6148681640625, 144.84906005859375, 144.08462524414062, 143.3209991455078, 142.56076049804688, 141.80752563476562, 141.05966186523438, 140.32247924804688, 139.5969696044922, 138.8789520263672, 138.15431213378906, 137.4319305419922, 136.71456909179688, 136.001953125, 135.29641723632812, 134.59725952148438, 133.90882873535156, 133.21835327148438, 132.53102111816406, 131.8437042236328, 131.16131591796875, 130.48312377929688, 129.80667114257812, 129.1376953125, 128.47406005859375, 127.81607055664062, 127.16371154785156, 126.51216125488281, 125.86033630371094, 125.21190643310547, 124.56687927246094, 123.92790985107422, 123.29476165771484, 122.66639709472656, 122.04109954833984, 121.41598510742188, 120.79107666015625, 120.17152404785156, 119.55781555175781, 118.95069885253906, 118.35137176513672, 117.76033020019531, 117.16847229003906, 116.5713119506836, 115.96839904785156, 115.3705825805664, 114.77892303466797, 114.19495391845703, 113.61700439453125, 113.04344177246094, 112.47366333007812, 111.90603637695312, 111.33882141113281, 110.76946258544922, 110.20514678955078, 109.64720916748047, 109.09403228759766, 108.5472183227539, 108.00634002685547, 107.47209167480469, 106.93167877197266, 106.3891830444336, 105.84819030761719, 105.31497192382812, 104.78697967529297, 104.2626953125, 103.74164581298828, 103.2225341796875, 102.70263671875, 102.18333435058594, 101.66871643066406, 101.15846252441406, 100.65023803710938, 100.14640808105469, 99.64842987060547, 99.1537094116211, 98.66120910644531, 98.17019653320312, 97.68133544921875, 97.19447326660156, 96.70794677734375, 96.22498321533203, 95.74699401855469, 95.27214050292969, 94.80259704589844, 94.33360290527344, 93.86566162109375, 93.39513397216797, 92.92683410644531, 92.46549224853516, 92.01234436035156, 91.56328582763672, 91.11687469482422, 90.66963195800781, 90.21475982666016, 89.76103210449219, 89.30477905273438, 88.85597229003906, 88.41807556152344, 87.98734283447266, 87.558837890625, 87.13265228271484, 86.70266723632812, 86.26994323730469, 85.84093475341797, 85.41881561279297, 85.00090026855469, 84.590087890625, 84.18545532226562, 83.78675842285156, 83.37939453125, 82.96934509277344, 82.55995178222656, 82.15340423583984, 81.7559814453125, 81.36235046386719, 80.9716796875, 80.58477020263672, 80.20170593261719, 79.81788635253906, 79.4328842163086, 79.04986572265625, 78.66758728027344, 78.28589630126953, 77.90595245361328, 77.52804565429688, 77.15101623535156, 76.77655792236328, 76.40097045898438, 76.02364349365234, 75.64501953125, 75.26689147949219, 74.8895263671875, 74.51441192626953, 74.14277648925781, 73.77396392822266, 73.40673828125, 73.03805541992188, 72.6688232421875, 72.29788208007812, 71.93028259277344, 71.56787109375, 71.20892333984375, 70.85118103027344, 70.49273681640625, 70.13478088378906, 69.77824401855469, 69.4261245727539, 69.07501220703125, 68.72384643554688, 68.37470245361328, 68.0278091430664, 67.68260192871094, 67.33564758300781, 66.98927307128906, 66.64806365966797, 66.31043243408203, 65.97486877441406, 65.63951110839844, 65.3048095703125, 64.97119140625, 64.63858795166016, 64.30635070800781, 63.974857330322266, 63.64590072631836, 63.31915283203125, 62.994956970214844, 62.67194747924805, 62.350990295410156, 62.02912521362305, 61.705020904541016, 61.37890625, 61.056907653808594, 60.73951721191406, 60.42740249633789, 60.118309020996094, 59.811317443847656, 59.502479553222656, 59.189208984375, 58.87731170654297, 58.56908416748047, 58.265113830566406, 57.964420318603516, 57.6660041809082, 57.368896484375, 57.0717658996582, 56.77558898925781, 56.478187561035156, 56.17683029174805, 55.87291717529297, 55.571327209472656, 55.27485656738281, 54.98467254638672, 54.699951171875, 54.41563034057617, 54.129852294921875, 53.84320068359375, 53.55724334716797, 53.274314880371094, 52.993202209472656, 52.71284484863281, 52.43351745605469, 52.15589904785156, 51.879058837890625, 51.6051025390625, 51.334014892578125, 51.0655403137207, 50.798011779785156, 50.53080749511719, 50.26268005371094, 49.99579620361328, 49.73133850097656, 49.46936798095703, 49.208396911621094, 48.94771957397461, 48.687599182128906, 48.42808532714844, 48.169952392578125, 47.91440200805664, 47.6610107421875, 47.409912109375, 47.1600341796875, 46.91320037841797, 46.66697692871094, 46.419395446777344, 46.16619873046875, 45.91246032714844, 45.66108322143555, 45.413063049316406, 45.16651153564453, 44.921051025390625, 44.67573547363281, 44.432029724121094, 44.189178466796875, 43.94789123535156, 43.70808410644531, 43.470550537109375, 43.234169006347656, 42.99854278564453, 42.762184143066406, 42.523956298828125, 42.2872314453125, 42.054325103759766, 41.82463073730469, 41.59766387939453, 41.369163513183594, 41.13751983642578, 40.90327453613281, 40.668785095214844, 40.43696212768555, 40.209022521972656, 39.983795166015625, 39.75868225097656, 39.532135009765625, 39.304534912109375, 39.078147888183594, 38.85414123535156, 38.63133239746094, 38.40913391113281, 38.18644714355469, 37.964088439941406, 37.74298858642578, 37.524375915527344, 37.30720520019531, 37.09025955200195, 36.87240219116211, 36.65234375, 36.431217193603516, 36.21006774902344, 35.992942810058594, 35.77734375, 35.56315612792969, 35.34864044189453, 35.13450622558594, 34.920257568359375, 34.706077575683594, 34.49102783203125, 34.27655029296875, 34.06257247924805, 33.84934616088867, 33.63843536376953, 33.429710388183594, 33.22266387939453, 33.014068603515625, 32.805091857910156, 32.597267150878906, 32.39238739013672, 32.19000244140625, 31.989036560058594, 31.787109375, 31.58185577392578, 31.37429428100586, 31.16775894165039, 30.96398162841797, 30.763967514038086, 30.566076278686523, 30.369342803955078, 30.171037673950195, 29.970752716064453, 29.76913070678711, 29.568056106567383, 29.370765686035156, 29.175628662109375, 28.980947494506836, 28.78591537475586, 28.58932876586914, 28.39220428466797, 28.19733428955078, 28.00490951538086, 27.81519317626953, 27.626718521118164, 27.439435958862305, 27.252986907958984, 27.067100524902344, 26.88239288330078, 26.699377059936523, 26.517051696777344, 26.334407806396484, 26.151626586914062, 25.969593048095703, 25.789051055908203, 25.610992431640625, 25.433944702148438, 25.257705688476562, 25.081737518310547, 24.905364990234375, 24.730724334716797, 24.556011199951172, 24.38326644897461, 24.210472106933594, 24.03833770751953, 23.867185592651367, 23.69612693786621, 23.526260375976562, 23.35738754272461, 23.189224243164062, 23.020156860351562, 22.851537704467773, 22.68604850769043, 22.52411651611328, 22.364612579345703, 22.205974578857422, 22.04595375061035, 21.883800506591797, 21.722026824951172, 21.5626163482666, 21.407323837280273, 21.252456665039062, 21.09724235534668, 20.938791275024414, 20.779685974121094, 20.62162971496582, 20.4669189453125, 20.3142147064209, 20.162883758544922, 20.01047706604004, 19.85685157775879, 19.703975677490234, 19.553754806518555, 19.40742301940918, 19.264314651489258, 19.122966766357422, 18.97968101501465, 18.834999084472656, 18.690229415893555, 18.546415328979492, 18.402610778808594, 18.258975982666016, 18.11440658569336, 17.970054626464844, 17.827861785888672, 17.68832015991211, 17.550716400146484, 17.415355682373047, 17.280445098876953, 17.14678192138672, 17.014076232910156, 16.883808135986328, 16.753719329833984, 16.622791290283203, 16.488920211791992, 16.35369300842285, 16.22126007080078, 16.095569610595703, 15.974079132080078, 15.853219032287598, 15.72891616821289, 15.59947395324707, 15.469198226928711, 15.342164993286133, 15.219317436218262, 15.100605964660645, 14.980583190917969, 14.860252380371094, 14.739171028137207, 14.619288444519043, 14.502647399902344, 14.389965057373047, 14.27832317352295, 14.165441513061523, 14.051509857177734, 13.93765640258789, 13.826026916503906, 13.715468406677246, 13.607650756835938, 13.496648788452148, 13.383329391479492, 13.267261505126953, 13.151922225952148, 13.038779258728027, 12.92779541015625, 12.816251754760742, 12.701602935791016, 12.584444999694824, 12.468511581420898, 12.354952812194824, 12.244566917419434, 12.135894775390625, 12.029569625854492, 11.925186157226562, 11.823380470275879, 11.723055839538574, 11.622727394104004, 11.520914077758789, 11.416922569274902, 11.312165260314941, 11.208732604980469, 11.10700798034668, 11.007889747619629, 10.909204483032227, 10.809144020080566, 10.707747459411621, 10.605745315551758, 10.506563186645508, 10.410165786743164, 10.314408302307129, 10.218300819396973, 10.121312141418457, 10.023993492126465, 9.928132057189941, 9.834404945373535, 9.744147300720215, 9.653356552124023, 9.561277389526367, 9.468231201171875, 9.374344825744629, 9.282003402709961, 9.192495346069336, 9.103446960449219, 9.015043258666992, 8.926200866699219, 8.838485717773438, 8.751630783081055, 8.665960311889648, 8.580838203430176, 8.494034767150879, 8.40644645690918, 8.319029808044434, 8.233461380004883, 8.149580001831055, 8.068504333496094, 7.987727165222168, 7.907271385192871, 7.826296806335449, 7.7446088790893555, 7.663700103759766, 7.583346843719482, 7.5041728019714355, 7.424949645996094, 7.34641170501709, 7.268475532531738, 7.190487861633301, 7.113183975219727, 7.035463333129883, 6.957459449768066, 6.880485534667969, 6.805814743041992, 6.733950138092041, 6.664864540100098, 6.596710205078125, 6.526113986968994, 6.453292369842529, 6.379787445068359, 6.308520317077637, 6.239605903625488, 6.171825408935547, 6.103394985198975, 6.033662796020508, 5.964019775390625, 5.89523458480835, 5.827916145324707, 5.761248588562012, 5.695002555847168, 5.628237724304199, 5.562036991119385, 5.497188568115234, 5.434276580810547, 5.373710632324219, 5.314513683319092, 5.255434036254883, 5.19560432434082, 5.135910987854004, 5.076885223388672, 5.018493175506592, 4.960127353668213, 4.900954246520996, 4.841784477233887, 4.784269332885742, 4.729909420013428, 4.67695951461792, 4.624540328979492, 4.571746349334717, 4.516648292541504, 4.46004056930542, 4.403772354125977, 4.347835063934326, 4.293648719787598, 4.2399163246154785, 4.187976837158203, 4.13656759262085, 4.086839199066162, 4.038580894470215, 3.991074323654175, 3.9420456886291504, 3.892064094543457, 3.8420252799987793, 3.793379306793213, 3.7477054595947266, 3.704021453857422, 3.6613032817840576, 3.6168198585510254, 3.5706210136413574, 3.5225014686584473, 3.4756243228912354, 3.4306745529174805, 3.387819528579712, 3.3469200134277344, 3.306817054748535, 3.266785144805908, 3.227121353149414, 3.188246726989746, 3.1500604152679443, 3.1109695434570312, 3.072086811065674, 3.0339338779449463, 2.9974265098571777, 2.9611244201660156, 2.9252705574035645, 2.887768268585205, 2.846853494644165, 2.8051815032958984, 2.765190601348877, 2.728276491165161, 2.6949098110198975, 2.663076639175415, 2.630977153778076, 2.5972986221313477, 2.5623912811279297, 2.5293757915496826, 2.4986140727996826, 2.4683361053466797, 2.4374566078186035, 2.4048168659210205, 2.371562957763672, 2.3394112586975098, 2.3097755908966064, 2.2830123901367188, 2.2568652629852295, 2.2302122116088867, 2.2025556564331055, 2.1735823154449463, 2.1443448066711426, 2.1145293712615967, 2.0841856002807617, 2.0533528327941895, 2.0237834453582764, 1.996132254600525, 1.9719631671905518, 1.9500808715820312, 1.9278086423873901, 1.9034643173217773, 1.8765110969543457, 1.8477627038955688, 1.8204681873321533, 1.7961366176605225, 1.7744765281677246, 1.754655361175537, 1.7349741458892822, 1.7141201496124268, 1.6927661895751953, 1.6689279079437256, 1.6446927785873413, 1.619302749633789, 1.5943386554718018, 1.5706288814544678, 1.5495566129684448, 1.5302032232284546, 1.5114333629608154, 1.491368293762207, 1.469764232635498, 1.446757435798645, 1.424503207206726, 1.4041261672973633, 1.3876874446868896, 1.37278151512146, 1.3566217422485352, 1.3387857675552368, 1.3189970254898071, 1.2991602420806885, 1.2807953357696533, 1.2628533840179443, 1.2454438209533691, 1.2298157215118408, 1.215038776397705, 1.2016723155975342, 1.1890926361083984, 1.176241159439087, 1.1628756523132324, 1.1477210521697998, 1.1322383880615234, 1.118009328842163, 1.1052467823028564, 1.0926997661590576, 1.0799956321716309, 1.0650734901428223, 1.0481101274490356, 1.0310444831848145, 1.0148855447769165, 1.0002671480178833, 0.9865742921829224, 0.9726752042770386, 0.9584107398986816, 0.9439973831176758, 0.9304401278495789, 0.9194836616516113, 0.910431444644928, 0.901872992515564, 0.8922662138938904, 0.8820143938064575, 0.8693972229957581, 0.8558073043823242, 0.8431190252304077, 0.8318266868591309, 0.8213794827461243, 0.8131312727928162, 0.8069919347763062, 0.8026072978973389, 0.7977644801139832, 0.7888401746749878, 0.7746130228042603, 0.7577764391899109, 0.7395559549331665, 0.7252950072288513, 0.7153338193893433, 0.7092757225036621, 0.7042636275291443, 0.6987306475639343, 0.6903582215309143, 0.6798433065414429, 0.6693308353424072, 0.6607911586761475, 0.6553004384040833, 0.6516624689102173, 0.6483136415481567, 0.6432492136955261, 0.637688159942627, 0.6315328478813171, 0.6241682767868042, 0.6156589984893799, 0.606623649597168, 0.5980398654937744, 0.5924094319343567, 0.5872237682342529, 0.5824892520904541, 0.5762549638748169, 0.5678626298904419, 0.5592249631881714, 0.5521055459976196, 0.5471092462539673, 0.5430928468704224, 0.5402786731719971, 0.5361867547035217, 0.530924916267395, 0.5247969627380371, 0.5195049047470093, 0.5150901079177856, 0.5105984210968018, 0.5053007006645203, 0.49872955679893494, 0.49299514293670654, 0.48698410391807556, 0.48231664299964905, 0.4776288866996765, 0.4725630283355713, 0.46631789207458496, 0.4607853293418884, 0.4565424621105194, 0.4528442919254303, 0.4492824077606201, 0.44360923767089844, 0.436774343252182, 0.4306948781013489, 0.42571407556533813, 0.42529743909835815, 0.4260627329349518, 0.42652514576911926, 0.42327821254730225, 0.4168250560760498, 0.40701374411582947, 0.39881962537765503, 0.392905592918396, 0.38991519808769226, 0.388450026512146, 0.38770100474357605, 0.3859521150588989, 0.3823249340057373, 0.3760799765586853, 0.3682119846343994, 0.35995787382125854, 0.35440850257873535, 0.35170888900756836, 0.3540180027484894, 0.35911762714385986, 0.36555320024490356, 0.36951082944869995, 0.368580162525177, 0.3634859323501587, 0.3560991585254669, 0.3505817651748657, 0.34617334604263306, 0.34385979175567627, 0.341214120388031, 0.33820509910583496, 0.33600670099258423, 0.33432748913764954, 0.3346988558769226, 0.334031879901886, 0.33080244064331055, 0.32728511095046997, 0.3241499662399292, 0.3206929564476013, 0.3173835873603821, 0.31362858414649963, 0.3082450032234192, 0.3012043535709381]

loss = loss / np.max(loss)
stage = list(range(50, 1000+1, 50))

# Define custom colors in a dark color scheme
color_blue = '#002147'
color_red = '#8C1515'

# Set the figure size
plt.figure(figsize=(10, 4))

# Plot SSIM with markers
ax1 = plt.gca()
ax1.set_ylabel('SSIM')
ax1.plot(stage, ssim, marker='o', linestyle='-', label='SSIM', color=color_blue)

# Plot Loss with markers
ax2 = plt.twinx()
ax2.set_ylabel('Relative Loss')
ax2.plot(np.arange(len(loss)), loss, label='Relative Loss', color=color_red)

# Set x-axis label
ax1.set_xlabel('Steps')

ax1.axvline(x=950, color='#777777aa', linestyle='dashed')
ax2.text(950 + 10, 0.35, 'Threshold $\mathcal{T}$', rotation=90, color='gray', fontsize=12)

ax2.set_ylim([0, np.max(loss)])

# Show legend in one box
lines, labels = ax1.get_legend_handles_labels()
lines2, labels2 = ax2.get_legend_handles_labels()
ax2.legend(lines + lines2, labels + labels2, loc='lower right')


# Adjust the alignment of twin axes
ax1.spines['left'].set_color(color_blue)
ax1.spines['right'].set_visible(False)
ax1.yaxis.label.set_color(color_blue)
ax1.tick_params(axis='y', colors=color_blue)
ax2.spines['right'].set_color(color_red)
ax2.spines['left'].set_visible(False)
ax2.yaxis.label.set_color(color_red)
ax2.tick_params(axis='y', colors=color_red)
# Set the title

# Add grid
plt.grid(color='white', linestyle='-', linewidth=0.5)

# Set the layout and padding
plt.tight_layout(pad=1.0)

plt.title("CeleA-HQ")
# Save the figure
plt.savefig('run/ssim_loss2.pdf', dpi=300)
plt.savefig('run/ssim_loss2.png', dpi=300)

plt.close()

